import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { AlertTriangle, AlertOctagon, Info, ArrowRight, Check, X, Copy, Brain } from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { motion, AnimatePresence } from "framer-motion";
import { useState } from "react";
export function VulnerabilityCard({ vuln, index }) {
    const [showFix, setShowFix] = useState(false);
    const severityColor = {
        critical: "text-red-500 border-red-500/20 bg-red-500/5",
        high: "text-orange-500 border-orange-500/20 bg-orange-500/5",
        medium: "text-yellow-500 border-yellow-500/20 bg-yellow-500/5",
        low: "text-blue-500 border-blue-500/20 bg-blue-500/5",
    };
    const severityIcon = {
        critical: AlertOctagon,
        high: AlertTriangle,
        medium: AlertTriangle,
        low: Info,
    };
    const Icon = severityIcon[vuln.severity];
    return (_jsxs(motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, transition: { delay: index * 0.1 }, className: cn("border rounded-xl p-6 bg-card/50 backdrop-blur-sm hover:border-primary/20 transition-all", "border-white/5"), children: [_jsxs("div", { className: "flex items-start justify-between gap-4 mb-4", children: [_jsxs("div", { className: "flex items-start gap-4", children: [_jsx("div", { className: cn("p-2.5 rounded-lg", severityColor[vuln.severity]), children: _jsx(Icon, { className: "h-6 w-6" }) }), _jsxs("div", { children: [_jsxs("div", { className: "flex items-center gap-2 mb-1", children: [_jsx("h3", { className: "font-bold text-lg", children: vuln.title }), _jsx(Badge, { variant: "outline", className: "font-mono text-[10px] uppercase tracking-wider opacity-70", children: vuln.cwe })] }), _jsxs("div", { className: "flex items-center gap-2 text-sm text-muted-foreground font-mono", children: [_jsx("span", { className: "text-primary/70", children: vuln.file }), _jsx("span", { children: ":" }), _jsxs("span", { children: ["L", vuln.line] })] })] })] }), _jsx(Badge, { className: cn("uppercase font-bold", severityColor[vuln.severity]), children: vuln.severity })] }), _jsx("p", { className: "text-muted-foreground mb-6 text-sm leading-relaxed max-w-3xl", children: vuln.description }), _jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6", children: [_jsxs("div", { className: "bg-black/40 rounded-lg border border-white/5 overflow-hidden", children: [_jsxs("div", { className: "bg-white/5 px-3 py-1.5 border-b border-white/5 flex items-center justify-between", children: [_jsx("span", { className: "text-xs font-mono text-muted-foreground", children: "Vulnerable Code" }), _jsxs("div", { className: "flex gap-1.5", children: [_jsx("div", { className: "h-2 w-2 rounded-full bg-red-500/50" }), _jsx("div", { className: "h-2 w-2 rounded-full bg-white/10" }), _jsx("div", { className: "h-2 w-2 rounded-full bg-white/10" })] })] }), _jsx("pre", { className: "p-4 font-mono text-xs overflow-x-auto text-red-200/80", children: _jsx("code", { children: vuln.codeSnippet }) })] }), _jsx(AnimatePresence, { mode: "wait", children: showFix ? (_jsxs(motion.div, { initial: { opacity: 0 }, animate: { opacity: 1 }, exit: { opacity: 0 }, className: "bg-black/40 rounded-lg border border-green-500/20 overflow-hidden relative group", children: [_jsxs("div", { className: "bg-green-500/10 px-3 py-1.5 border-b border-green-500/20 flex items-center justify-between", children: [_jsxs("span", { className: "text-xs font-mono text-green-400 flex items-center gap-2", children: [_jsx(Brain, { className: "h-3 w-3" }), "AI Suggested Fix"] }), _jsx(Button, { variant: "ghost", size: "icon", className: "h-4 w-4 text-green-400 hover:text-green-300", onClick: () => navigator.clipboard.writeText(vuln.suggestedFix), children: _jsx(Copy, { className: "h-3 w-3" }) })] }), _jsx("pre", { className: "p-4 font-mono text-xs overflow-x-auto text-green-200/80", children: _jsx("code", { children: vuln.suggestedFix }) }), _jsx(Button, { className: "absolute bottom-3 right-3 h-7 text-xs bg-green-500 hover:bg-green-600 text-black", onClick: () => setShowFix(false), children: "Apply Fix" })] })) : (_jsx("div", { className: "flex items-center justify-center border border-dashed border-white/10 rounded-lg bg-white/5 min-h-[120px]", children: _jsxs(Button, { variant: "outline", className: "gap-2 border-primary/30 hover:bg-primary/10 hover:text-primary", onClick: () => setShowFix(true), children: [_jsx(Brain, { className: "h-4 w-4" }), "Generate AI Fix"] }) })) })] })] }));
}
//# sourceMappingURL=vulnerability-card.js.map